USE ROLE ACCOUNTADMIN;
USE DATABASE ACOLYTE_DB;
USE SCHEMA DEV;
USE WAREHOUSE ACOLYTE_WH;


SELECT * FROM ACOLYTE_DB.DEV.CAST_AND_CHARACTERS;


SELECT
    WHO,
    DESCRIPTION,
    CONCAT(
    'Actor and character they played: ' || WHO,
    '\n\n\nHistory of the engagement: \n' || DESCRIPTION
    ) as listing_text
FROM ACOLYTE_DB.DEV.CAST_AND_CHARACTERS
;


CREATE OR REPLACE CORTEX SEARCH SERVICE ACOLYTE_DB.DEV.ACOLYTE_PLOT_SVC_CAST
ON listing_text
ATTRIBUTES WHO, DESCRIPTION
WAREHOUSE = ACOLYTE_WH
TARGET_LAG = '1 hour'
AS
SELECT
    WHO,
    DESCRIPTION,
    CONCAT(
    'Actor and character they played: ' || WHO,
    '\n\n\nHistory of the engagement: \n' || DESCRIPTION
    ) as listing_text
FROM ACOLYTE_DB.DEV.CAST_AND_CHARACTERS
;


SHOW CORTEX SEARCH SERVICES;
DESCRIBE CORTEX SEARCH SERVICE ACOLYTE_DB.dev.ACOLYTE_PLOT_SVC_CAST;
-- DROP CORTEX SEARCH SERVICE ACOLYTE_DB.dev.ACOLYTE_PLOT_SVC_CAST;
